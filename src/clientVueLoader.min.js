/**
 * Made by Julio Treviño Páez
 */
!function(t,e){"object"==typeof module&&"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.clientVueLoader=e(),t.Vue&&t.Vue.use&&t.Vue.use(t.clientVueLoader)}(this,function(){"use strict";let t=0;const e=Object.getPrototypeOf(async function(){}).constructor;let n={},r=async t=>t;const o={},s={async template(t,e){if(null!==e){if("string"!=typeof e)throw new Error(`The returned value of the ${t.langAttribute} processor for the <template> tag must be String.`);t.content=e}if(0===t.element.content.children.length)throw new Error(`The the <template> tag must have at least one root element.\n${t.content}`);if(t.element.content.children.length>1)throw new Error(`The the <template> tag must have just one root element.\n${t.content}`)},async script(t,e){if(null!==e){if(!(e instanceof Object))throw new Error(`The returned value of the ${t.langAttribute} processor for the <script> tag must be an Object.`);return e}const n=function(t){return window[t]},o=async function(e,n){return p.createLoadFunction(new URL(e,t.component.url),n)()},s={exports:{}};try{Function("exports","require","clientVueLoader","module",t.content).call(s.exports,s.exports,n,o,s)}catch(e){if(!("lineNumber"in e))throw e;throw new Error(`${e.message} at ${t.component.url}:${e.lineNumber-1}`)}if(s.exports instanceof Promise&&await s.exports,!((e=await r(s.exports))instanceof Object))throw new Error(`The value of the module.exports must be an Object.\n${t.component.content}`);return e},async style(t,e){if(null!==e){if("string"!=typeof e)throw new Error(`The returned value of the ${t.langAttribute} processor for the <template> tag must be String.`);t.content=e}const n=null!==t.component.template,r=null!==t.component.script,o=t.element.hasAttribute("scoped"),s=t.element.hasAttribute("scoped-inside"),u=t.element.hasAttribute("module");if(o+s+u>1)throw new Error(`The <style> has more than one self-exclusive attribute: scoped, scoped-inside and module.\n ${t.content}`);if(t.component.head.appendChild(t.element),o){if(!n)throw new Error(`The <style> has the scoped attribute but there is no <template> tag in the vue file.\n ${t.component.content}`);return t.element.removeAttribute("scoped"),async function(t,e){const n="["+e+"]";const r=[l(t,n,function(t){const e=[];return t.selectorText.split(i).forEach(function(t){const r=t.match(a);let o=r[1]+n;r[2]&&(o+=r[2]+n),o.replace(":scope",n),e.push(o)}),e.join(",")+t.cssText.substr(t.selectorText.length)})];t.component.template.alreadyScoped||(t.component.template.alreadyScoped=!0,r.push(async function t(e,n){e.setAttribute(n,"");for(let r=0;r<e.children.length;r++){let o=e.children[r];await t(o,n)}}(t.component.template.firstChild,e)));return Promise.all(r)}(t,t.component.scopeId)}if(s){if(!n)throw new Error(`The <style> has the scoped-inside attribute but there is no <template> tag in the vue file.\n ${t.component.content}`);return t.element.removeAttribute("scoped-inside"),t.component.template.firstChild.setAttribute(t.component.scopeId,""),async function(t,e){const n="["+e+"]";return l(t,n,function(t){const e=[];return t.selectorText.split(i).forEach(function(t){e.push(n+" "+t);const r=t.match(a);e.push(r[1]+n+(r[2]||""))}),e.join(",")+t.cssText.substr(t.selectorText.length)})}(t,t.component.scopeId)}if(u){if(!n)throw new Error(`The <style> has the module attribute but there is no <template> tag in the vue file.\n ${t.component.content}`);if(!r)throw new Error(`The <style> has the module attribute but there is no <script> tag in the vue file.\n ${t.component.content}`);let e=t.element.getAttribute("module");return e=e||"$style",t.component.hasModuleStyles=!0,t.element.removeAttribute("module"),async function(t,e,n){const r="["+n+"]",o={};if(await l(t,r,function(t){const e=[];return t.selectorText.split(i).forEach(function(t){e.push(function t(e){const r=e.match(c);if(r){let e=o[r[2]];return e||(e=o[r[2]]=`${n}__${r[2]}`),r[1]+"."+e+t(r[3])}return e}(t))}),e.join(",")+t.cssText.substr(t.selectorText.length)}),Object.freeze(o),!t.component.script)throw new Error(`The <style module> tag cannot be compiled if there is no an <script> tag.\n${t.content}`);return[e,o]}(t,e,t.component.scopeId)}}},i=/\s*,\s*/,a=/([^ :]+)(.+)?/,c=/^(.*?)\.([\w-]+)(.*)$/;async function l(t,e,n){const r=t.element.sheet,o=r.cssRules;for(let t=0;t<o.length;++t){const s=o[t];if(1===s.type)r.insertRule(n(s,e),t),r.deleteRule(t+1);else if(4===s.type){let o="";for(let t=0;t<s.cssRules.length;++t){const r=s.cssRules[t];1===r.type&&(o+=n(r,e))}const i="@media "+s.conditionText+"{"+o+"}";r.insertRule(i,t),r.deleteRule(t+1)}}}class u{constructor(t,e){this.component=t,this.element=e,this.result=null,this.element.hasAttribute("src")?(this.srcAttribute=this.element.getAttribute("src"),this.element.removeAttribute("src")):this.srcAttribute=null,this.element.hasAttribute("lang")?(this.langAttribute=this.element.getAttribute("lang"),this.element.removeAttribute("lang")):this.langAttribute=null}get tagName(){return this.element.nodeName.toLowerCase()}get content(){return this.element.innerHTML}get firstChild(){return(this.element.content||this.element).children[0]}set content(t){this.element.innerHTML=t}async normalize(){this.srcAttribute&&(this.content=await p.httpRequest(new URL(this.srcAttribute,this.component.url)))}async compile(){const t=s[this.tagName];if(!t)throw new Error(`There isn't a compiler for tag <${this.tagName}>\n${this.element.outerHTML}`);let e=null;null!==this.langAttribute&&(e=await p.langProcessor[this.langAttribute].call(this)),this.result=await t(this,e)}}class h{constructor(t,e){this.name=t,this.url=e,this.content=null,this.moduleStyles=null,this.exports=null,this._scopeId=null,this.template=null,this.script=null,this.tags={}}get head(){return document.head||document.getElementsByTagName("head")[0]}get scopeId(){return null===this._scopeId&&(this._scopeId="data-s-"+(t++).toString(36)),this._scopeId}addTag(t){const e=t.tagName;this.tags[e]=this.tags[e]||[],this.tags[e].push(t)}async load(){this.content=await p.httpRequest(this.url);const t=document.implementation.createHTMLDocument("");t.head.innerHTML+=`<base href="${this.url}">`,t.body.innerHTML=this.content;for(let e=0;e<t.body.children.length;e++){let n=t.body.children[e];switch(n.nodeName){case"TEMPLATE":if(this.template)throw new Error(`Duplicated <template> tag at url(${this.url})\n${this.content}`);this.template=new u(this,n),this.addTag(this.template);break;case"SCRIPT":if(this.script)throw new Error(`Duplicated <script> tag at url(${this.url})\n${this.content}`);this.script=new u(this,n),this.addTag(this.script);break;default:this.addTag(new u(this,n))}}if(this.template||this.script)return this;throw new Error(`There isn't a template or a script tag in the loaded vue document at url(${this.url})\n${responseText}`)}async normalize(){const t=[];for(let e in this.tags)for(let n of this.tags[e])t.push(n.normalize());await Promise.all(t)}async compile(){const t=[];this.script&&await this.script.compile();for(let e in this.tags)if("script"!==e)for(let n of this.tags[e])t.push(n.compile());if(await Promise.all(t),this.tags.style){const t={};for(let e of this.tags.style)if(e.result){const[n,r]=e.result;t[n]?Object.assign(t[n],r):t[n]=r}for(let e in t)Object.freeze(t[e]);this.moduleStyles=t}}}class p{constructor(){this.urlPrefix="url:",this.autoNameProperty="cvl-auto-name",this.pathRegex=/\/([a-zA-Z_][a-zA-Z_0-9]*(?:"-"?[a-zA-Z_0-9]+)*?)(?:\.[^\.]+)?$/}install(t){const e=this;t.mixin({created(){const n=this.$options.components,r={},o=this.$data._baseUrl?this.$data._baseUrl:document.URL;if(n[e.autoNameProperty]){const s=n[e.autoNameProperty];if(!(s instanceof Array))throw new Error(`The ${e.autoNameProperty} property of components should be an array of Strings.`);for(let i of s){if("string"!=typeof i)throw new Error(`The ${e.autoNameProperty} property of components should be an array of Strings.`);const s=new URL(i,o),a=s.pathname.match(e.pathRegex);if(null===a)throw new Error(`The URL(${s.pathname}) has not a correct name to set for an auto-component.`);if(n[a[1]])throw new Error(`There is already a component by name ${a[1]}.`);r[a[1]]=t.component(a[1],p.createLoadFunction(s,a[1]))}delete n[e.autoNameProperty]}for(let t in n){const r=n[t];if("string"==typeof r&&r.startsWith(e.urlPrefix)){const e=new URL(r.substr(4),o);n[t]=p.createLoadFunction(e,t)}}Object.assign(n,r)}}),Object.defineProperty(t.prototype,"$style",{enumerable:!0,configurable:!0,get(){return this.$data.$style},set(){throw new Error("The $style property is read-only.")}})}clearCache(){n={}}registerLangProcessor(t,n){if(!(n instanceof e))throw new Error("The language processor must be a function.");o[t]=n}registerCompileFunction(t,e){if(!(e instanceof Function))throw new Error("The compiler must be a function.");s[t]=e}registerExportsHandler(t){if(!(t instanceof e))throw new Error("The compiler must be a function.");r=t}async load(t,e){return p.createLoadFunction(new URL(t),e)()}static createLoadFunction(t,e){return async function(){try{let r=n[t];if(!r){r=new h(e,t),await r.load(),await r.normalize(),await r.compile();const o=r.exports=null!==r.script?r.script.result:{};if(null!==r.template){if(o.template)throw new Error("There is already a template function or string in module.exports that collides with the template tag (<template>) defined in the vue component.");o.template=r.template.content}void 0===o.name&&(o.name=r.name),o.mixins=[{data:function(){const t={_baseUrl:r.url,_component:r};for(let e in r.moduleStyles)t[e]=r.moduleStyles[e];return t}}],n[t]=r}return r.exports}catch(t){throw console.error(t),t}}}static async httpRequest(t){return new Promise(function(e){const n=new XMLHttpRequest;n.open("GET",t),n.onreadystatechange=function(){if(4===n.readyState){if(!(n.status>=200&&n.status<300))throw new Error("[error] Cannot load "+t);e(n.responseText)}},n.send(null)})}}return new p});